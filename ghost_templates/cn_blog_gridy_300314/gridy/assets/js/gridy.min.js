(function(e){"use strict";function o(e){var t=/.*\.vimeo\.com\/video\/(\d+)/;var n=e.match(t);return n?n[1]:0}function u(e){var t=/youtube(-nocookie)?\.com\/(embed|v)\/([\w_-]+)/;var n=e.match(t);return n?n[3]:0}function a(e){var t=/soundcloud.com\/tracks\/(\d+)/;var n=e.match(t);return n?n[1]:0}function f(){e("head").append('<link rel="stylesheet" type="text/css" href="/assets/css/magnific-popup.css">');e(".post-content").find("img").each(function(){var t=e(this);t.wrap('<a class="image-link" href="'+t.attr("src")+'"></a>');e(".image-link").parents("p").addClass("image-p")});e.getScript("/assets/js/jquery.magnific-popup.min.js",function(){e(".image-link").magnificPopup({gallery:{enabled:true},type:"image"})})}function l(){e(".post").each(function(){e(this).find(r).wrap('<div class="post-video"></div>')})}function c(){e(".post").each(function(){e(this).find(s).wrap('<div class="post-audio"></div>')})}function h(){if(e(".author-link").length){e(".author-link").click(function(){e("html, body").animate({scrollTop:e(e(this).attr("href")).offset().top},300);return false})}}function p(){if(e(".comments-link").length){e(".comments-link").click(function(){e("html, body").animate({scrollTop:e(e(this).attr("href")).offset().top},300);return false})}}function d(){window.megaAPI=e(".megafolio-container").megafoliopro({layoutarray:TAThemeOptions.grid.layout,paddingHorizontal:7,paddingVertical:7,filterChangeAnimation:TAThemeOptions.grid.animation,filterChangeSpeed:600,filterChangeRotate:99,filterChangeScale:.6});var t=jQuery(".pagination span").html().split(" of ");e(".megafolio-container").infinitescroll({navSelector:".pagination",nextSelector:".pagination a",itemSelector:".post",debug:false,dataType:"html",appendCallback:false,animate:true,extraScrollPx:200,maxPage:parseInt(t[1])},function(t,n,r){t.addClass("new-post-entry hidden");for(var i=0;i<t.length;i++){megaAPI.megaappendentry(t[i].outerHTML)}var s=e(".megafolio-container");var o=s.data("opt");if(o.filterChangeSpeed==undefined)o.filterChangeSpeed=Math.round(Math.random()*500+100);if(o.filterChangeScale==undefined)o.filterChangeScale=.8;var u=0;var a=0;setTimeout(function(){e(".megafolio-container").find(".new-post-entry").each(function(t){var n=e(this);n.removeClass("hidden");n.removeClass(".new-post-entry");var r=o.filterChangeRotate;if(r==undefined)r=30;if(r==99)r=Math.round(Math.random()*360);if(o.filterChangeAnimation=="fade"){n.transition({scale:1,opacity:0,rotate:0,duration:0,queue:false});n.transition({scale:1,opacity:1,rotate:0,duration:1,queue:false})}else if(o.filterChangeAnimation=="scale"){n.transition({scale:o.filterChangeScale,opacity:0,rotate:0,duration:0,queue:false});n.transition({scale:1,opacity:1,rotate:0,duration:1,queue:false})}else if(o.filterChangeAnimation=="rotate"){n.transition({scale:1,opacity:0,rotate:r,duration:0,queue:false});n.transition({scale:1,opacity:1,rotate:0,duration:1,queue:false})}else if(o.filterChangeAnimation=="rotatescale"){n.transition({scale:o.filterChangeScale,opacity:0,rotate:r,duration:0,queue:false});n.transition({scale:1,opacity:0,rotate:0,duration:1,queue:false})}else if(o.filterChangeAnimation=="pagetop"||o.filterChangeAnimation=="pagebottom"||o.filterChangeAnimation=="pagemiddle"){n.find(".mega-entry-innerwrap").transition({scale:1,opacity:0,duration:0,queue:false});n.find(".mega-entry-innerwrap").addClass(o.filterChangeAnimation);n.find(".mega-entry-innerwrap").transition({scale:1,opacity:1,perspective:"10000px",rotateX:"90deg",duration:1,queue:false})}v(n)});megaAPI.megaRefresh()},500)})}function v(s){if(!s){s=e(".post")}s.each(function(){var s=e(this);if(s.find(".post-content-digest img").length){var f=s.find(".post-content-digest img").first();s.find(".mega-entry-innerwrap").css("background-image","url("+f.attr("src")+")");s.addClass("post-format-image post-with-thumbnail")}else if(s.find(".post-content-digest").find(t).length){var f=s.find(".post-content-digest").find(r).first();var l=o(f.attr("src"));if(l){e.getJSON("http://www.vimeo.com/api/v2/video/"+l+".json?callback=?",function(e){var t=e[0];s.find(".mega-entry-innerwrap").css("background-image","url("+t.thumbnail_large+")");s.addClass("post-format-video post-with-thumbnail")})}}else if(s.find(".post-content-digest").find(n).length){var f=s.find(".post-content-digest").find(n).first();var c=u(f[0].outerHTML);if(c){e.getJSON("http://gdata.youtube.com/feeds/api/videos/"+c+"?alt=json",function(e){var t=e["entry"]["media$group"]["media$thumbnail"][0];s.find(".mega-entry-innerwrap").css("background-image","url("+t.url+")");s.addClass("post-format-video post-with-thumbnail")})}}else if(s.find(".post-content-digest").find(i).length){var f=s.find(".post-content-digest").find(i).first();var h=a(f[0].outerHTML);if(h){var p="849aa50b8899e097dc78de1486686cc1";e.getJSON("http://api.soundcloud.com/tracks/"+h+".json?client_id="+p,function(e){var t=e["artwork_url"];if(t){var n=t.replace("-large.jpg","-t500x500.jpg");s.find(".mega-entry-innerwrap").css("background-image","url("+n+")");s.addClass("post-format-video post-with-thumbnail")}else{var r=e["user"]["avatar_url"];if(r){var i=r.replace("-large.jpg","-t500x500.jpg");s.find(".mega-entry-innerwrap").css("background-image","url("+i+")");s.addClass("post-format-video post-with-thumbnail")}}})}}})}function m(){e.each(TAThemeOptions.socialAccounts.accounts,function(t,n){if(n){var r=t;if(t=="vimeo"){r=t+"-square"}if(t=="email"){r="envelope"}if(t=="donation"){r="coffee"}if(TAThemeOptions.socialAccounts.colorful){e("#social-accounts").append('<a class="'+t+'" href="'+n+'"><i class="fa fa-'+r+'"></i></a>')}else{e("#social-accounts").append('<a href="'+n+'"><i class="fa fa-'+r+'"></i></a>')}}})}function g(){if(TAThemeOptions.disqus.enabled){if(e("body").hasClass("post-template")){e("#post-comments").show()}}else{e(".comments-count-bullet").remove()}if(TAThemeOptions.socialAccounts.enabled){m()}}var t='iframe[src*="vimeo.com"]';var n='iframe[src*="youtube.com"], iframe[src*="youtube-nocookie.com"], embed[src*="youtube.com"], embed[src*="youtube-nocookie.com"]';var r=[n,t].join(", ");var i='iframe[src*="soundcloud.com"]';var s=[i].join(", ");e(document).ready(function(){if(e("body").hasClass("home-template")){d();v()}else if(e("body").hasClass("archive-template")){d();v()}else if(e("body").hasClass("post-template")){if(e(".post-content").find("img").length){f()}if(e(".post-content").find(r).length){l()}if(e(".post-content").find(s).length){c()}h();p()}g()})})(jQuery)